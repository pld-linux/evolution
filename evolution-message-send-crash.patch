From 84f0a15b38c9934cf6cfef7f1b988cce20c11501 Mon Sep 17 00:00:00 2001
From: Milan Crha <mcrha@redhat.com>
Date: Wed, 29 Sep 2010 09:12:52 +0000
Subject: Bug #630700 - Crash on message send

---
diff --git a/mail/mail-ops.c b/mail/mail-ops.c
index ae2d12d..7f84b3b 100644
--- a/mail/mail-ops.c
+++ b/mail/mail-ops.c
@@ -607,8 +607,9 @@ mail_send_message (struct _send_queue_msg *m,
 				g_string_append_printf (
 					err, _("Failed to append to %s: %s\n"
 					"Appending to local 'Sent' folder instead."),
-					sent_folder_uri, local_error->message);
-				g_clear_error (&local_error);
+					sent_folder_uri, local_error ? local_error->message : _("Unknown error"));
+				if (local_error)
+					g_clear_error (&local_error);
 			}
 		}
 
--
cgit v0.8.3.1
